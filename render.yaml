# Render Blueprint for NeoFinance Backend
# This file allows one-click deployment to Render
# Usage: Connect repository to Render and it will auto-detect this file

services:
  - type: web
    name: neofinance-backend
    runtime: python
    plan: free
    region: singapore
    buildCommand: pip install -r backend/requirements.txt
    startCommand: cd backend && uvicorn main:app --host 0.0.0.0 --port $PORT
    envVars:
      - key: PYTHON_VERSION
        value: 3.12.0
      - key: DATABASE_URL
        sync: false  # Set manually in Render dashboard (from Supabase)
      - key: SECRET_KEY
        sync: false  # Generate and set manually
        # Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
      - key: ALGORITHM
        value: HS256
      - key: ACCESS_TOKEN_EXPIRE_MINUTES
        value: 30
      - key: API_V1_PREFIX
        value: /api/v1
      - key: PROJECT_NAME
        value: NeoFinance API
      - key: DEBUG
        value: False
      - key: CORS_ORIGINS
        sync: false  # Update after Vercel deployment
        # Format: https://your-app.vercel.app,https://your-app-*.vercel.app,http://localhost:5173
      - key: GEMINI_API_KEY
        sync: false  # Set manually from Google AI Studio
      - key: ENVIRONMENT
        value: production

    healthCheckPath: /

# Notes:
# 1. Before deploying, prepare these values:
#    - DATABASE_URL from Supabase
#    - SECRET_KEY (generate new secure key)
#    - GEMINI_API_KEY from Google AI Studio
#    - CORS_ORIGINS (update after Vercel deployment)
#
# 2. After deployment:
#    - Note the Render URL (https://neofinance-backend.onrender.com)
#    - Add this URL to Vercel environment variables
#    - Update CORS_ORIGINS in Render with Vercel domain
#
# 3. Free tier limitations:
#    - Spins down after 15 minutes of inactivity
#    - ~30 second cold start on first request
#    - 750 hours/month free compute
